---
title: "BIO8102 term project: The effect of Bti on soil microbiome in Kanata, Ontario, Canada "
author: "Rui Zhang"
date: "3/26/2021"
output: html_document
bibliography: reference.bib
---
*data used in this project can be found in my github repository: (https://github.com/Rui-Zzhang/BIO8102-Term-Project)

## 1 Introduction (10%)
### 1.1 Background

*Bacillus thuringiensis subsp. israelensis* (Bti) is a biolarvicde that is widely used in Europe and North America for mosquito control, due to its reputation of being an effective, environmentally-friendly and mosquito-specific biocide @despres2011. As a bio-larvicide, the toxicity of Bti to mosquito larvae is associated with its Cry and Cyt toxins produced as crystals during bacterial sporulation, which are solubilized in the gut of the mosquito larvae after ingestion @ben-dov2014. The toxins can then bind to certain protein receptors on the gut cell membrane, leading to the oligomerization and disruption of the gut, which ultimately cause the larval death @vachon2012. The specificity of this toxin makes it an ideal larvicide to control larvae of the suborder Nematocera, which includes mosquitoes, black flies and chironomids @bruhl2020. 

For the above benefits, the City of Ottawa initiated a pilot project to investigate the effect of Bti on eliminating the local mosquito population in Kanata in response to increased complains from local residents about mosquito nuisance. The bio-larvicide was applied for three years in South March Highlands Conservation Forest (SMHCF) from 2016 to 2018.  With the close monitoring of its effects on mosquito populations, the University of Ottawa MSc student Liam Epp collected data about the number of mosquitos in the Bti treated and control sites, along with the sediments from those area. His study concluded that statistical modelling failed to show Bti treatment as a significant predictor of mosquito quantities @epp2018. 


### 1.2 Study system and hypothese

As one of the drivers for biogeochemical cycling of various nutrient and other elements, soil microbiomes are essential for the survival and prosperity of plants and animal life @jansson2020. Following the lack of evidence of Bti as an effective bio-larvicide in reducing mosquito populations in Kanata, we thus wondered whether Bti can affect the local soil microbiocidal communities and alter their structures.

Bacillus thuringiensis (or Bt) is a Gram-positive, facultative anaerobic endospore-forming bacterium that is commonly found in soil as well as estuarine sediments. It can also be found naturally on leaf surfaces, aquatic environments, animal feces and insect-rich environment (ref: brock biology of microorganisms). Due to its soil-dwelling property, **we hypothesize that its application would alter the soil microbial structures, thus result in a change in microbial diversity as well as relative abundance.** 

## 2 Methods (20%)
### 2.1 Data collection 

Bti was applied in South March Highlands Conservation Forest (SMHCF) for three years from 2016 to 2018. As shown in figure 1, red circles represent the Bti treatment sites within SMHCF where soil samples were collected (i.e., 15 treatment sites), and the green dots represent the control sites without Bti treatment where soil samples were collected (i.e., 15 treatment sites). Soil sampling started a week after Bti was applied each year. Sampling was conducted from May to August on a weekly basis in each year (i.e., 12 weeks per year), thus soil at each sampling location was collected repeatedly for 12 times each year. 

However, the above methodologies are only an ideal scenario, and an incomplete dataset were provided in reality. Data from 2016 were largely missing, thus has to be excluded. For 2017 and 2018, we only have data available for 7 treatment sites (site number: 1,4,6,9,12,14,15) and 6 control sites (site number: 19, 20, 23, 24, 28, 30). In addition, the number of times each sampling location was measured vary from 3 to 5, nothing close to what was originally proposed of 12 times. 

![Figure 1. Map of SMHCF treatment and control areas; 15 Bti-treated (red dots) and 15 control sites (green dots) are illustrated. ](figure-1.png){width=50%}

Soil samples were collected near water ponds, then pH, Conductivity (uS), temperature (deg Celsius) and dissolved oxygen (DO) (mg/L), as well as the concentration of ammonia (mg/L) and nitrate(mg/L) were recorded along with the soil samples. Soil samples then subsequently underwent DNA extract and sent to a sequencing facility for 16S rRNA sequencing. The samples were processed and analyzed using the Quantitative Insights into Microbial Ecology (QIIME2, version 2020.8) @bolyen2019 custom pipeline. Alpha diversity metrics were obtained, which are measures of species diversity within a sample. Here we obtained three alpha diversity metrics generated by QIIME2 including Shannon’s diversity index, Pielou’s Evenness and Faith’s Phylogenetic Diversity, which are all continuous real numbers. 

### 2.2 Statistical approach
In this project, we will be mainly examining the effect of Bti treatment on these three-alpha diversity metrices by accounting for the physical chemical parameters as well as week and year using various statistical approach. 

#### 2.2.1 General linear mixed model

Loading relevant packages 
```{r message=FALSE}
library(lme4)
library(tidyverse)
library(patchwork)
library(lattice)
```

Let's inspect the data first. Please note that the `TreatP` column shows if a site is desginated as a bti-treated site or a control site without any treatment. `BTI` represents the treatment sites and `CTRL` represents the control sites. 
```{r}
kanata_data <- read.csv("BIO8102_bti_metadata.csv")
str(kanata_data)
```

Let's we convert `Week`, `Year` and `TreatP` into factors. 
```{r}
kanata_data <- mutate(
  kanata_data,
  Week = factor(Week),
  Year = factor(Year),
  TreatP = factor(TreatP))
```

Now, let's check the replications of each categories in our datasite. 
```{r}
# check replication for each `Week` within each treatment type `TreatP`.
(reptab <- with(kanata_data, table(TreatP, Week)))

# check replication for each `Site` within each treatment type `TreatP` 
(reptab <- with(kanata_data, table(TreatP, Site)))

# check replication for each `Site` within each treatment type `TreatP` 
(reptab <- with(kanata_data, table(TreatP, Year)))
  # Here for 2016 data, the number of replications for BTI and CTRL are much less than that of 2017, 2018 due to insufficient sampling efforts in that year. Let's try to remove 2016 data. 

kanata_data_filtered <- subset(kanata_data, Year!="2016")
```

Let's start with an initial plot of the alpha diversity metrics against treatment types. 
```{r echo=FALSE, message=FALSE, fig.width=5, fig.height=5}
library(gridExtra)
shannon_treatp <- ggplot(kanata_data_filtered, aes(x = TreatP, y = shannon_entropy)) +
  geom_jitter(
    alpha = 0.5,
    width = 0.05) +
  labs(
    x = "treatment type",
    y = "Shannon diversity"
  ) +
  theme_classic()

pielou_treatp <- ggplot(kanata_data_filtered, aes(x = TreatP, y = pielou_evenness)) +
  geom_jitter(
    alpha = 0.5,
    width = 0.05) +
  labs(
    x = "treatment type",
    y = "Pielou evenness"
  ) +
  theme_classic()

faith_treatp <- ggplot(kanata_data_filtered, aes(x = TreatP, y = faith_pd)) +
  geom_jitter(
    alpha = 0.5,
    width = 0.05) +
  labs(
    x = "treatment type",
    y = "Faith pd"
  ) +
  theme_classic()
grid.arrange(shannon_treatp, pielou_treatp, faith_treatp, ncol=3)

```



Just by visualizing the plots, it seems that Bti treatment did not create much differences in terms of the three metrics.

Let's try to fit a liner mixed models with TreatP and year as fixed effect, sites as a random effect intercept, (i.e., since each site was measured repeatedly). Here I am only going to use Shannon diversity since the distributions of the three metrics look pretty similar.
```{r}
m1_1 <- lmer(shannon_entropy ~ TreatP + Year + (1 | Site), data = kanata_data_filtered)
summary(m1_1)
confint(m1_1)

m2_1 <- lmer(shannon_entropy ~ TreatP + Year + (Year | Site) , data = kanata_data_filtered)
summary(m2_1)

?isSingular

```
The random effect section measure the variability for `Site`. The among-site variance is 0.0622 with a standard deviation of 0.249. The residual has a value of 0.322, representing the variability that's not due to variation among `Site`, which is a lot higher than the variability within `Site`. This reflects that something else has contributed to the variability in the model, that we have not accounted for. 

For the fixed effects section, TreatP:CTRL has a value of 0.026, which is the slope for this categorical effect of `TreatP`. This means that on average, the shannon index in control sites are higher than that in treatment sites by 0.026, which is not of too much interest. 

#### 2.2.2


## 3 Results (25%)

## 4 Discussion (15%)

## Style (30%)
* clarity and code reproducibility (10%)
* organization (5%)
* clarity of text (10%)
* Typos and grammar (5%)

## 5 Reference




